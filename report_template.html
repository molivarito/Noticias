<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <title>Resumen {{ report_type }} de Noticias</title>
    <style>
        body { font-family: 'Roboto', sans-serif; line-height: 1.6; margin: 0; padding: 20px; background-color: #f4f7f6; color: #333; }
        .container { max-width: 900px; margin: 30px auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 6px 12px rgba(0,0,0,0.08); }
        h1 { font-family: 'Montserrat', sans-serif; color: #2c3e50; text-align: center; margin-bottom: 15px; font-weight: 700; font-size: 2.2em; }
        .report-timestamp { text-align: center; font-size: 0.9em; color: #555; margin-top: -10px; margin-bottom: 35px; }
        h2 { font-family: 'Montserrat', sans-serif; color: #34495e; border-bottom: 3px solid #1abc9c; padding-bottom: 12px; margin-top: 40px; margin-bottom: 25px; font-weight: 600; font-size: 1.8em; }
        details { background-color: #fdfdfd; border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 20px; padding: 20px; box-shadow: 0 3px 6px rgba(0,0,0,0.04); transition: box-shadow 0.3s ease; }
        details:hover { box-shadow: 0 5px 10px rgba(0,0,0,0.06); }
        details[open] { background-color: #ffffff; border-left: 5px solid #1abc9c; }
        summary { font-family: 'Montserrat', sans-serif; font-weight: 600; cursor: pointer; color: #2980b9; font-size: 1.15em; margin-bottom: 8px; list-style-position: inside; outline: none; }
        .article-content-wrapper { padding-top: 10px; }
        .article-title { font-size: 1.15em; font-weight: bold; color: #343a40; margin-bottom: 5px; }
        .article-meta { font-size: 0.85em; color: #6c757d; margin-bottom: 8px; }
        .article-summary { margin-top: 10px; color: #495057; }
        a { color: #007bff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .no-articles { text-align: center; font-style: italic; color: #6c757d; margin: 40px 10px; font-size: 1.1em; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Resumen {{ report_type }} de Noticias</h1>
        <p class="report-timestamp">Generado el: {{ generation_timestamp }}</p>
        
        {% if not articles_by_category or not articles_by_category.values() | select('any') | list %}
            <p class='no-articles'>No se encontraron noticias nuevas para este reporte.</p>
        {% else %}
            {% for categoria, articulos in articles_by_category.items() %}
                {% if articulos %}
                    <h2>{{ category_icons.get(categoria, category_icons.default) }} {{ categoria.replace('_', ' ')|title }}</h2>
                    {% for item in articulos %}
                    <details>
                        <summary>{{ item.resumen_datos.teaser_sentence | default('Click para ver más') }} (Puntuación: {{ item.resumen_datos.relevancia_score | default('N/A') }}/10)</summary>
                        <div class="article-content-wrapper">
                            <p class="article-title">{{ item.info.titulo | default('Sin título') }}</p>
                            <p class="article-meta">Fuente: {{ item.info.source_name | default('N/A') }} | Fecha: {{ item.info.fecha_str | default('N/A') }} | Justificación: {{ item.resumen_datos.relevancia_justificacion | default('N/A') }}</p>
                            <p class="article-summary">{{ item.resumen_datos.resumen | default('No hay resumen disponible.') }}</p>
                            <a href='{{ item.info.link | default('#') }}' target='_blank'>Leer más en la fuente original</a>
                        </div>
                    </details>
                    {% endfor %}
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>
</body>
</html>